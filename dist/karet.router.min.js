!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("karet"),require("karet.util"),require("prop-types"),require("ramda"),require("partial.lenses"),require("kefir"),require("history")):"function"==typeof define&&define.amd?define(["exports","karet","karet.util","prop-types","ramda","partial.lenses","kefir","history"],r):r((e.karet=e.karet||{},e.karet.router=e.karet.router||{}),e.karet,e.U,e.P,e.R,e.L,e.Kefir,e.H)}(this,function(e,r,t,n,o,i,a,u){"use strict";function c(e,r){var t={};for(var n in e)r.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}r="default"in r?r.default:r;var f=t.default,l=function(e){e.preventDefault(),e.stopPropagation()},s=(t.lift1Shallow(function(e){return/^https?:\/\//.test(e)}),function(e,r){for(var t=arguments.length,n=Array(t>2?t-2:0),o=2;o<t;o++)n[o-2]=arguments[o];if(!e){var i=void 0;if(r){var a=0;i=new Error(r.replace(/%s/g,function(){return n[a++]})),i.name="Invariant Violation"}else i=new Error("Minified exception");throw i.framesToPop=1,i}}),p=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},v=function(){function e(e,r){var t=[],n=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(n=(a=u.next()).done)&&(t.push(a.value),!r||t.length!==r);n=!0);}catch(e){o=!0,i=e}finally{try{!n&&u.return&&u.return()}finally{if(o)throw i}}return t}return function(r,t){if(Array.isArray(r))return r;if(Symbol.iterator in Object(r))return e(r,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),h=function(e){return!!(e.altKey||e.ctrlKey||e.metaKey||e.shiftKey)},y=o.curry(function(e,r,t){if(l(t),!h(t)){var n=/^((\/[^?#]*)([?][^#]*)?)?([#].*)?$/.exec(r),o=v(n,5),i=o[2],a=void 0===i?"":i,u=o[3],c=void 0===u?"":u,f=o[4],s=void 0===f?"":f;e.set({pathname:a,search:c,hash:s})}}),d=t.withContext(function(e,t){var n=t["karet.router"].location,o=e.href,i=(e.onClick,c(e,["href","onClick"]));return r.createElement("a",p({href:o,onClick:y(n,o)},i))});d.propTypes={href:n.string,onClick:n.func};var m=o.pipe(i.collect([i.props("pathname","search","hash"),i.values]),o.join("")),k=u.createBrowserHistory(),b=function(){return k.location},w=t.atom(b());a.stream(function(e){k.listen(function(r,t){return e.emit({next:r,action:t})})}).observe(function(e){var r=e.next;return"POP"===e.action&&w.set(r)}),w.observe(function(e){o.equals(e,b())||k.push(m(e))});var x=function(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}({},"karet.router",{location:w,pathname:t.view("pathname",w)}),q=function(){return r.createElement("div",null,"Not Found")},g=function(e,r){return i.get([r,i.define(q)],e)},j=t.withContext(function(e,n){var o=e.routes,i=n["karet.router"].pathname;return t.fromKefir(f(i,function(e){return r.createElement(g(o,e))}))});j.propTypes={routes:n.object.isRequired};var O=function(e){var n=e.routes;return s(n,"<Router> requires a route configuration"),r.createElement(t.Context,{context:x},r.createElement(j,{routes:n}))};O.propTypes={routes:n.object.isRequired},e.Link=d,e.Router=O,Object.defineProperty(e,"__esModule",{value:!0})});
